{% extends 'base.html' %}
{% load static %}
{% block content %}
    <div class="slogan container container--90">
        <div class="slogan--item">
            <h1>
                Zacznij pomagać!<br/>
                Oddaj niechciane rzeczy w zaufane ręce
            </h1>
        </div>
    </div>
    <section id="stats" class="stats">
        <div class="container container--85">
            <div class="stats--item">
                <em>{{ bags_number }}</em>
                <h3>Oddanych worków</h3>
                <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Eius est beatae, quod accusamus illum
                    tempora!</p>
            </div>

            <div class="stats--item">
                <em>{{ organiation_number }}</em>
                <h3>Wspartych organizacji</h3>
                <p>Lorem ipsum dolor sit amet consectetur, adipisicing elit. Laboriosam magnam, sint nihil cupiditate
                    quas quam.</p>
            </div>

        </div>
    </section>

    <section id="steps" class="steps">
        <h2>Wystarczą 4 proste kroki</h2>

        <div class="steps--container">
            <div class="steps--item">
                <span class="icon icon--hands"></span>
                <h3>Wybierz rzeczy</h3>
                <p>ubrania, zabawki, sprzęt i inne</p>
            </div>
            <div class="steps--item">
                <span class="icon icon--arrow"></span>
                <h3>Spakuj je</h3>
                <p>skorzystaj z worków na śmieci</p>
            </div>
            <div class="steps--item">
                <span class="icon icon--glasses"></span>
                <h3>Zdecyduj komu chcesz pomóc</h3>
                <p>wybierz zaufane miejsce</p>
            </div>
            <div class="steps--item">
                <span class="icon icon--courier"></span>
                <h3>Zamów kuriera</h3>
                <p>kurier przyjedzie w dogodnym terminie</p>
            </div>
        </div>

        <a href="{% url 'register' %}#register" class="btn btn--large">Załóż konto</a>
    </section>

    <section id="about-us" class="about-us">
        <div class="about-us--text">
            <h2>O nas</h2>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Voluptas vitae animi rem pariatur incidunt
                libero optio esse quisquam illo omnis.</p>
            <img src="images/signature.svg" class="about-us--text-signature" alt="Signature"/>
        </div>
        <div class="about-us--image"><img src="images/about-us.jpg" alt="People in circle"/></div>
    </section>

    <section id="help" class="help">
        <h2>Komu pomagamy?</h2>
        <p>W naszej bazie znajdziesz listę zweryfikowanych Fundacji, z którymi współpracujemy. Możesz sprawdzić
            czym
            się zajmują, komu pomagają i czego potrzebują.</p>
        <ul class="help--buttons">
            {% for key, value in insitution_types %}
                {% if forloop.counter == 1 %}
                    <li
                            onclick="onClick('{{ key }}', '{{ forloop.counter }}')"
                            data-id="{{ forloop.counter }}">
                        <a
                                data-id="{{ forloop.counter }}"
                                href="#"
                                id="{{ key }}"
                                class="btn fund btn--without-border active">{{ value }}</a>
                    </li>
                {% else %}
                    <li
                            onclick="onClick('{{ key }}{{ forloop.counter }} ')"
                            data-id="{{ forloop.counter }}"><a
                            data-id="{{ forloop.counter }}"
                            id="{{ key }}"
                            href="#"
                            class="btn fund btn--without-border">{{ value }}</a>
                    </li>
                {% endif %}
            {% endfor %}

        </ul>

        <!-- SLIDE 1 -->
        <div class="help--slides active" data-id="1">
            <p>W naszej bazie znajdziesz listę zweryfikowanych Fundacji, z którymi współpracujemy. Możesz sprawdzić czym
                się zajmują, komu pomagają i czego potrzebują.</p>

            <ul class="help--slides-items 1">

            </ul>
            <!-- Pagination
            <ul class="help--slides-pagination">
              <li><a href="#" class="btn btn--small btn--without-border active" data-page="1">1</a></li>
              <li><a href="#" class="btn btn--small btn--without-border" data-page="2">2</a></li>
              <li><a href="#" class="btn btn--small btn--without-border" data-page="3">3</a></li>
            </ul>
            -->
        </div>


        <!-- SLIDE 2 -->
        <div class="help--slides" data-id="2">
            <p>
                Lorem ipsum dolor, sit amet consectetur adipisicing elit. Hic officiis mollitia dolor, neque aspernatur
                accusamus debitis. Ducimus, officia. Quia, sunt illum! Non iste placeat ab ipsum alias
                quos suscipit corporis!
            </p>
            <ul class="help--slides-items 2">

            </ul>

            <!-- Pagination
            <ul class="help--slides-pagination">
              <li><a href="#" class="btn btn--small btn--without-border active" data-page="1">1</a></li>
              <li><a href="#" class="btn btn--small btn--without-border" data-page="2">2</a></li>
              <li><a href="#" class="btn btn--small btn--without-border" data-page="3">3</a></li>
              <li><a href="#" class="btn btn--small btn--without-border" data-page="4">4</a></li>
              <li><a href="#" class="btn btn--small btn--without-border" data-page="5">5</a></li>
            </ul>
            -->
        </div>

        <!-- SLIDE 3 -->
        <div class="help--slides" data-id="3">
            <p>Lorem ipsum dolor sit amet, his ocurreret persequeris ea, ad utinam laudem duo. Verterem adipisci
                partiendo eos ne, ea his reque quaeque recteque, ne quo lobortis intellegam.</p>
            <ul class="help--slides-items 3">

            </ul>

            <!-- Pagination
            <ul class="help--slides-pagination">
              <li><a href="#" class="btn btn--small btn--without-border active" data-page="1">1</a></li>
              <li><a href="#" class="btn btn--small btn--without-border" data-page="2">2</a></li>
            </ul>
            -->
        </div>
    </section>
{% endblock %}
{% block script %}
    <script src="https://code.jquery.com/jquery-3.5.0.min.js"
            integrity="sha256-xNzN2a4ltkB44Mc/Jz3pT4iU1cmeR0FkXs4pru/JxaQ=" crossorigin="anonymous"></script>
    <script>


        const createInstitutionHtml = (i, id) => {
            const ul = document.getElementsByClassName(`help--slides-items ${id}`)[0]
            const li = document.createElement('li')
            li.innerHTML = `<div class="col">
            <div class="title">${i.name}</div>
            <div class="subtitle">${i.description}</div>
            </div>
            <div class="col">
                 <div class="text">${i.categories}</div>
            </div>
            `

            ul.appendChild(li)
        }
        const inst = document.getElementsByClassName('btn fund active')[0]
        const getInstitutions = (id, counter) => {
            $.ajax({
                url: 'http://127.0.0.1:8000/api/institutions/',
                data: {
                    'id': JSON.stringify(id)
                },
                dataType: 'json'
            }).done((res) => {
                const institutions = JSON.parse(res.inst)
                const ul = document.getElementsByClassName(`help--slides-items ${counter}`)[0]
                if (ul) {
                    ul.innerHTML = ''
                    institutions.forEach(i => {
                        createInstitutionHtml(i, counter)
                    })
                }

            }).fail((err) => {
                console.log(err)
            })
        }
        getInstitutions(inst.id, inst.dataset.id)


        const onClick = (id) => {
            getInstitutions(id[0], id[1])
        }

    </script>
{% endblock %}